---
share: true
tags:
 - NET/ASPNETCore/routing
 - NET/Razor
---
# Выбор обработчика страницы для вызова
Уже [[ch-5-routing-to-razor-pages|упоминалось]] что [[routing|маршрутизация]] заключается в сопоставлении URL-адресов с обработчиком, а также, что`RoutingMiddleware` выбирает страницу Razor на основе URL-адреса и [[route-template|шаблона маршрута]]. Однако, страницы Razor могут иметь несколько обработчиков, поэтому рассмотрим, как `EndpointMiddleware` выбирает, какой обработчик страницы вызвать.
Рассмотрим страницу `SearchModel` с тремя обработчиками.
```csharp
public class SearchModel : PageModel
{
	public void OnGet() //Обрабатывает GET-запросы
	{
		...
	}
	
	public Task OnPostAsync() //Обрабатывает POST запросы. Async в целях маршрутизации игнорируется
	{
		...
	}
	
	public void OnPostCustomSearch() //Обрабатывает POST-запросы, в которых значение маршрута handler=CustomSearch
	{
		...
	}
}
```
Когда `EndpointMiddleware` выполняет выбранную страницу Razor, то выбирает обработчик страницы на основе двух переменных:
- HTTP-метода, используемого в запросе;
- [[route-value|значения маршрута]] `handler`

Если не включить параметр маршрута в шаблон, `handler` будет браться из строки запроса: `/search?handler=CustomSearch`. Если добавить параметр в шаблон, например `@page "{handler}"`, то будет использован запрос вида `/search/customsearch`.
Итак, конкретный обработчик выбирается по имени вида `On{verb}[handler][Async]`.
Если ни один обработчик не подошел (например, нет обработчика `OnDelete()`), выполняется *неявный* обработчик, не содержащий логики; при этом просто возвращается ассоциированное представление Razor. Исключением является HTTP-метод HEAD: если явного обработчика `OnHead()` нет, выполняется `OnGet()`, если он существует.