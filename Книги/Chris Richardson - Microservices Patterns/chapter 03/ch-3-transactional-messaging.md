---
share: true
tags: 
 - microservice/messaging
 - microservice/communication
 - microservice/transactions
---
# Транзакционный обмен сообщениями
Сервисы часто нужно публиковать сообщения в рамках транзакции, обновляющей базу данных. Если не отправить сообщение одновременно с записью в БД, система может остаться в несогласованном состоянии.
Предлагается следующий механизм для надёжной отправки сообщений:
1. Первый шаг — воспользуемся шаблоном [[transactional-outbox-pattern|Публикация событий (Outbox)]] для временного сохранения сообщений.
1. Второй шаг — передаем сообщения, сохраненные на первом шаге, брокеру. Для этого возможно применить следующие шаблоны:
	- [[polling-publisher-pattern|Опрашивающий издатель]]
	- [[transaction-log-tailing-pattern|Отслеживание транзакционного журнала]]