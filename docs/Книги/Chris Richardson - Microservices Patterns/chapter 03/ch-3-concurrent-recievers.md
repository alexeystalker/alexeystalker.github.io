---
share: true
tags: 
 - microservice/messaging
 - microservice/concurrency
 - message-broker
---
# Конкурирующие получатели и порядок следования сообщений
В случае ситуации нескольких одинаковых получателей возможна ситуация, когда несколько последовательных сообщений будут доставлены в некорректном порядке разным экземплярам получателей.
Одно из решений — использование *сегментированных каналов*.
![[Pasted image 20210915203724.png]]
1. Сегментированный канал включает в себя два и более сегмента, каждый из которых ведет себя как канал.
2. Отправитель указывает в заголовке ключ сегмента. Брокер по ключу определяет сегмент, в который попадает сообщение.
3. Брокер сопоставляет сегмент одному экземпляру получателя.