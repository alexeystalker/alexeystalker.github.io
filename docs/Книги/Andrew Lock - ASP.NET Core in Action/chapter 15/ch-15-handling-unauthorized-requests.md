---
share: true
tags:
 - NET/ASPNETCore/authorization
 - security
---
# Обработка запросов, не прошедших аутентификацию
Если пользователь отвечает требованиям авторизации, то запрос проходит беспрепятственно через компонент `AuthorizationMiddleware`, а конечная точка выполняется в `EndpointMiddleware`. Если он не отвечает требованиям, `AuthorizationMiddleware` отклоняет запрос:
![[Pasted image 20220618145738.png]]
При этом (см. картинку) генерируется один из двух вариантов ответов:
- *вызов (challenge)* - этот ответ указывает на то, что пользователь не выполнил вход;
- *запрет (forbid)* - этот ответ указывает на то, что пользователь выполнил вход, но не отвечает требованиям.

> [!Info] Примечание
> Атрибут `[Authorize]` в [[ch-15-preventing-anonymous-users-from-accessing-your-application|базовой форме]] будет генерировать ответы типа "вызов"

Точный ответ HTTP, сгенерированный "вызовом" или "запретом", обычно зависит от типа приложения.

Для традиционных веб-приложений, например, использующих [[ch-14-what-is-asp-net-core-identity|ASP.NET Core Identity]] вызовы и запреты генерируют HTTP-перенаправление на соответствующую страницу приложения; "вызов" - на страницу аутентификации, "запрет" - на страницу с информацией о запрете.

Веб-API, напротив, обычно просто отвечает `401 Unauthorized` для "вызова" и `403 Forbidden` для запрета.