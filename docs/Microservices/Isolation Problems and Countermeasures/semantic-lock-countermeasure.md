---
share: true
tags:
 - microservice/transaction
 - microservice/isolation/countermeasure
---
# Контрмера “семантическая блокировка”
При использовании семантической блокировки [[saga-compensating|компенсируемая транзакция]] устанавливает флаг во всех записях, которые она создает или обновляет. Флаг говорит о том, что запись *не зафиксирована* и может измениться. Флаг сбрасывается либо повторяемой (повествование успешно завершается), либо компенсирующей транзакцией (повествование откатывается обратно).
Также нужно решить, как каждое отдельное повествование будет обращаться с заблокированной записью. Например, можно просто откатиться. Либо можно блокироваться до снятия блокировки с записи. Однако в этом случае приложению нужно уметь находить взаимные блокировки и откатывать блокирующее повествование с последующим повторным выполнением.